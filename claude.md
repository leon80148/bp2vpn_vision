# BP2VPN Vision - 血壓資料匯出系統專案說明

## 專案概述
這是一個醫療資料處理系統，專門用於將 DBF 格式的病患血壓資料轉換為符合健保署規範的 XML 格式。

## 主要功能
- 從 DBF 檔案讀取病患基本資料和檢驗記錄
- 自動識別並配對血壓測量數據（收縮壓/舒張壓）
- 生成符合健保署「特約醫事服務機構每日上傳檢驗(查)結果」規範的 XML 檔案
- 支援批次處理多位病患資料

## 技術架構
- **程式語言**: Python 3.6+
- **主要套件**: dbf (用於讀取 DBF 檔案)
- **輸出格式**: XML (Big5 編碼)
- **作業環境**: Windows

## 資料來源
### DBF 檔案結構
1. **CO01M.DBF** - 病患主資料表
   - 包含病患基本資訊（姓名、身分證號、病歷號等）
   
2. **CO18H.DBF** - 檢驗歷史結果檔
   - 包含血壓等生理數據測量記錄

## XML 輸出格式
- 遵循健保署規範，使用 `<hdata>` 和 `<rdata>` 結構
- 血壓資料使用特定治療項目代號 `h7=0023`
- 收縮壓和舒張壓分別以獨立的 `<rdata>` 區塊記錄

## 使用流程
1. 準備病患病歷號清單（直接輸入或文字檔）
2. 執行程式自動讀取 DBF 檔案
3. 系統自動配對同時間測量的收縮壓/舒張壓
4. 輸出符合規範的 XML 檔案

## 安全注意事項
- DBF 檔案包含敏感病患資料，不應上傳至版本控制
- 輸出的 XML 檔案可能包含個人資料，需妥善保管
- 所有病患資料處理須符合醫療隱私相關法規

## 開發注意事項
- 病歷號會自動格式化為 7 位數（不足左補零）
- XML 特殊字元需以全形方式處理
- 編碼統一使用 Big5 以符合健保署要求
- 非必填欄位在無資料時可省略標籤

## 未來改進方向
- 加入更多資料驗證機制
- 支援更多檢驗項目類型
- 提供資料統計和報表功能
- 改善錯誤處理和日誌記錄